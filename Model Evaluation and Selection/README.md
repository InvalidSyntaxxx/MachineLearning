## 经验误差与过拟合

### 经验误差

也称训练误差，是在对比结果集在原来的训练集上的误差。

### 泛化误差

是对比结果集在新的数据集上的误差。

### 欠拟合

缺乏对训练集的样本特征提取。**（要求太松懈了）**

### 过拟合

对训练集的个例样本的独有特性误认为成所有潜在样本的特性。**（要求太苛刻了）**

常见例子：一组绿色树叶训练集，若训练出来的学习器发现绿色的东西都是树叶，则称为欠拟合；若学习器发现没有锯齿的不算是树叶，则称为过拟合。

个人理解图：

![image-20221113152407143](https://www.wangwangyz.site/%E4%B8%AA%E4%BA%BA%E5%9B%BE%E5%BA%8A/image-20221113152407143.png)

## 评估方法

### 留出法

将训练集的一部分留出来当作验证集。常见有100万个训练样本，使用20万用来验证，80万用来训练。

### 交叉验证法

也称 $k$折交叉验证法，将样本集平均划分为 $k$ 个子集，每次拿出 $k-1$ 的并集作为训练集，剩下的一个子集作为验证集。最终训练出 $k$ 个模型，返回结果为这 $k$ 个模型测试结果的均值。

> 交叉验证的特例
>
> **留一法**，既 m 个样本被划分为 m 个子集（划分唯一性），
>
> 特点：有多少个样本，就训练多少个模型

### 自助法

也叫放回采样法。m 个样本的样本集$D$，每次从中随机取出 1 个样本，放入 $D^{'}$ 中，并将这个样本放回 $D$。重复 m 次

新的样本集 $D'$ 既为训练集。

原始样本集$D$中某个样本不被采集到的概率：
$$
\lim_{m→\infty}(1-\frac{1}{m})^{m} = \frac{1}{e} = 36.8\%
$$
接着用 $D-D'$ 做测试集（包外测试）

**异同**：留出法和交叉验证适合样本集大的情况，自助法适合样本集小的情况。

## 性能度量

均方误差、精度、错误率

### 查准率查全率

查准率：“挑出来的瓜有多少是好瓜”

查全率：“多少好瓜被挑出来了”

- **二分类结果混淆矩阵**

- **P-R曲线**

- **BEP(Break-Even Point)→查准率=查全率**

- F1**度量**
  $$
  F1 = \frac{2 × P × R}{P+R} = \frac{2×TP}{样例总数+TP-TN}
  $$
  F1更一般形式：
  $$
  F_{β}=\frac{(1+β^{2})× P × R}{β^{2}×P+R}
  $$
  当 β = 1，则为F1；当β > 1，则偏向 查全率（逃犯信息检索）；当β < 1，则偏向 查准率（商品推荐系统）。

### ROC与AUC

ROC（“受试者工作特征”，Receiver Operating Characteristic）

横轴为假正例率，纵轴为真正例率
$$
FPR = \frac{FP}{TN+FP}~~~~~~~(假正例率)\\
TPR = \frac{TP}{TP+FN}~~~~~~~(真正例率)
$$
AUC（AreaUnder ROC Curve），既ROC曲线下面的面积，要判断哪个学习器的优劣，就比较AUC大小，AUC越大，学习器越好。

**微查全率、微查准率、微查全率F1、宏查全率、宏查准率、宏查准率F1**

## 偏差与方差